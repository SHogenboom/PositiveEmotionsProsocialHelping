---
title: "Online Appendix - Positive Emotions and Prosocial Helping"
author: "Sally A.M. Hogenboom"
date: "20-6-2017"
output: 
  html_document:
    code_folding: show
    number_sections: TRUE
    toc: TRUE
    toc_float: TRUE
    toc_depth: 2
    theme: paper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

``` {r include=FALSE, warning=FALSE}
library(yarrr)        # Pirateplots including distribution of data & means
library(psych)        # ICC / Independence of Observations
library(pastecs)
library(car)
library(Hotelling)    # Hotelling's T
library(mvnormtest)   # shapiro-wilk test / Multivariate normal distribution
library(biotools)     # boxM / homogeneity of covariance matrices
library(MASS)         # Discriminant Analysis
library(mvoutlier)    # to determine multivariate outliers
library(lsr)          # compute anova effect sizes
library(ggplot2)      # Vizualization of data
```

# Stimulus Materials
## Recruitement Text

The text that was used on the Univeristy of Amsterdam's lab website to recruite participants for the study.

> "The goal of the study is to better understand the language people use to describe emotional events. We do this by asking you to recall emotional events. The study takes approcimately 30 minutes and can be completed at home!"

***

## Emotion Induction 

### First Memory

We aimed to induce the target emotion (love, awe, pride, or neutral) by having participants recall three emotionally salient memories in which the participant experienced the target emotion. Participants were randomly assigned to one of four emotion induction conditions (love, awe, pride, neutral). Depending on the assigned condition, the fields were changed accordingly.

> "We are interested in the language people use to describe experiences in which they felt ${lm://Field/1}. To get a clear picture we ask you to ${lm://Field/2}. Please write 400-450 characters (i.e. ± 5 sentences) describing one of these recent memories. Please be aware that you will not receive any credits if you write gibberish words or if you copy the same sentence or story multiple times."

#### Field 1: Target Emotion

> * love
> * awe
> * pride
> * neutral

#### Field 2: Emotion Examples

**Love** 

> "Please take a few minutes to think about a particular time, fairly recently, when you experienced companionate love. This might have been feelings of warmth and affection toward platonic others, such as friends or family, in close but nonsexual relationships."Cavanaugh et al. (2015, p. 659)[^1]

**Awe** 

> "Please take a few minutes to think about a particular time, fairly recently, when you encountered a natural scene that caused you to feel awe. This might have been a sunset, a view from a high place, or any other time you were in a natural setting that you felt was beautiful."Piff et al. (2015, p. 887)[^2]

**Pride** 

> "Please take a few minutes to think about a particular time, fairly recently, when you felt pride. This might have been being accepted to a university, winning an event or competition, or any other time that you achieved a personal accomplishment."Piff et al. (2015, p. 887)[^2]

**Neutral** 

> "Please take a few minutes to think about something you did fairly recently. This might have been riding a bike, studying for a test, or any other thing that happened during your day."Piff et al. (2015, p. 887)[^2]

### Second + Third Memory

**After participants recalled their first memory, the following instruction prompted them to recall the second and third emotionally salient memories:**

> "Please write about another memory in which you felt ${lm://Field/1}. Please think of a different time than the one you previously described – this allows us to create as large an emotion lexicon as possible. Please write 400-450 characters (i.e. ± 5 sentences) describing one of these recent memories ${lm://Field/3}."

#### Field 3: 

**Love**

> "(For example, feeling warmth or affection towards platonic others such as friends or family)"

**Awe**

> "(For example, watching a natural setting such as the sunset)"

**Pride**

> "(For example, achieving a personal accomplishment)"

**Neutral**

> "(For example, anything that happend during your day)"

***

## Manipulation Checks

### Memory Intensity
**7-point Likert Scale - 1 item**

"On a scale from 1 (not at all) to 7 (a great deal) how intense was the event you recalled for you?"  

**Scoring**

*[1]* Not at all  *[4]* A moderate amount  *[7]* A great deal 

### Current Feelings - Positive Emotions

**7-point Likert Scale - 7 items**

"On a scale from 1 (does not describe my feelings) to 7 (clearly describes my feelings) I feel..."  

**Scoring**

*[1]* Does not describe my feelings *[4]* Moderately describes my feelings *[7]* Clearly describes my feelings"

* **Companionate love**. The feeling of warmth and affection toward platonic others, such as friends or family, in close but nonsexual relationships.
* **Awe**. The feeling when you encounter something that is greater or more powerful than yourself. You feel insignificant and need a moment to adjust.
* **Pride**. The feeling when you possess or have accomplished something that other people find praiseworthy. You feel vigorous and have the urge to show off to others.
* **Amusement**. The feeling when you encounter something silly, ironic, witty, or absurd, which makes you laugh. You have the urge to be playful and share the joke with others
* **Joy**. The feeling when something very good just happened to you. You have the urge to celebrate and share it with others.
* **Compassion**. The feeling when you witness that a person is suffering physically or emotionally. You want to help this person or lighten their suffering.
* **Contentment**.  The feeling when things are going well and there is nothing urgent to be done. You feel like relaxing and enjoying the present moment.

### Current Feelings - General Affect

**7-point Likert Scale - 3 items**

"You have just indicated to what extent you currently experience distinct emotions. We have a few more questions that cover a broader sense of how you currently feel."

**Scoring**

*[1]* Does not describe my feelings *[4]* Moderately describes my feelings *[7]* Clearly describes my feelings

* **Positive**
* **Negative**
* **Aroused:** The feeling of being physiologically alert and/or attentive.

***

## Demographics

**The last step before completing the study is to provide some demographical information.**

* **Gender** [Male/Female/Other...]
* **Age**
* **Nationality** [Dutch/Other...]

***

## Helping

> "This is the end of the study assessing how people use language to describe emotional experiences. However, before you close the browser (automatically saving all answers), researchers at ${lm://Field/1} want to ask for your help. They have recorded voice clips of different species and need help determining the most likely context in which these sounds were recorded. You can decide for yourself how many clips you would like to listen to, each clip is only a few seconds long. Would you be willing to help them? Please be aware that you will not receive additional credit for this, but you would help the researchers at ${lm://Field/1} greatly!"

### Field 1:

* University of Amsterdam  <- In-group
* Goethe University Frankfurt <- Out-group

***

## Debriefing

> "First of all, we would like to thank you for taking part in this study. We will check your data and add your participation credits as soon as possible.
  Before you started the experiment, we told you that we were studying how people use language to describe experiences in which they felt a specific emotion. Recalling these memories was done in order to elicit feelings in participants of either love, awe, pride, or a neutral control condition, depending on the conditions that you and the other participants were randomly assigned to.
  Our primary interest in this study, in fact, was whether participants would engage in helping another researcher or not. Previous studies have found that inducing positive emotions can make people donate more money to others. In this study we test whether positive emotions also make people help others more compared to participants who feel neutral. Please be aware that any of your peers might still take part in this research, please do not tell them about the true purpose of the study!
  If you have any additional questions about the research, or wish to learn more about the results of the study, please leave a comment or contact the lead researcher: Dr. D.A. Sauter (e-mail_1). If you have any ethical complaints about this study, please contact Dr. M. Rotteveel member of the ethics committee of the Social Psychology Department at the University of Amsterdam (e-mail_2).
  Kind regards,
Sally Hogenboom and Disa Sauter"

***
***

# Data Extraction + Preperation

## Data Extraction

Extract the data from Qualtrics Survey website:

1. Project name: "UNI - Positive Emotions and Prosocial Behavior"
2. Data & Analysis
3. Export & Import
4. Export Data
5. Download Table
6.  "CSV" + "Download all fields" + "use numeric values" + "remove line breaks" + "Use internal ID's in header"
7. Download
8. Open with Excel

***

## Data Preperation - *[Excel]*

  * Text to columns
      + Separated
      + Comma
      + Complete
      + Ignore warning message (replace cells with data)
  * Irrelevant Helping Task Data 
      + *[Helping task data stored in seperate embedded-data variables]*
      + **Removed Columns "BN" - "AKA"**
  * Irrelevant Question ID tags
      + **Removed Row 2**
  * Empty columns
      + **Removed Columns "J" - "M"**
  * Transform Helping_Finish & Helping_Start to number columns 

***

## Import Data

Load Correct File. Please change script depending on working directory and results file name.

``` {r}
setwd("~/Documents/Universiteit/Master/Internship")
dat <- read.csv(file = "Data_Final_Rversion.csv", header = TRUE, sep = ";")
```

``` {r include = FALSE}
## replace headers by meaningfull names

colnames(dat) <- c("StartDate",	"EndDate", "Status", "IPAddress",	"Progress",	"Duration (in seconds)",	"Finished", "RecordedDate",	"ResponseId",	"LocationLatitude",	"LocationLongitude",	"DistributionChannel", 
"Love_Consent", "Love_Stdnr", "Love_Memory1", "Love_Intensity1", "Love_Memory2", "Love_Intensity2",
"Love_Memory3", "Love_Intensity3", "Awe_Consent", "Awe_Stdnr", "Awe_Memory1", "Awe_Intensity1", 
"Awe_Memory2", "Awe_Intensity2", "Awe_Memory3", "Awe_Intensity3","Pride_Consent", "Pride_Stdnr", 
"Pride_Memory1", "Pride_Intensity1", "Pride_Memory2", "Pride_Intensity2","Pride_Memory3", 
"Pride_Intensity3", "Neutral_Consent", "Neutral_Stdnr", "Neutral_Memory1", "Neutral_Intensity1", 
"Neutral_Memory2", "Neutral_Intensity2", "Neutral_Memory3", "Neutral_Intensity3", "C_Love", "C_Awe", 
"C_Pride", "C_Amusement", "C_Joy", "C_Compassion", "C_Contentment", "C_Positive", "C_Negative", "C_Aroused", "Gender", "Other_Gender", "Age", "Nationality", "Other_Nationality", "Helping_Ingroup", "Helping_Outgroup", 
"Helping_Finish", "Helping_Start", "Trials", "Emotion_Condition", "Trial_Vector", "Recipient_Condition",
"tid_Labuva", "userid_labuva", "Device", "Helping", "Helping_Time")

# Set correct classes
dat$Love_Memory1 <- as.character(dat$Love_Memory1)
dat$Love_Memory2 <- as.character(dat$Love_Memory2)
dat$Love_Memory3 <- as.character(dat$Love_Memory3)
dat$Awe_Memory1 <- as.character(dat$Awe_Memory1)
dat$Awe_Memory2 <- as.character(dat$Awe_Memory2)
dat$Awe_Memory3 <- as.character(dat$Awe_Memory3)
dat$Pride_Memory1 <- as.character(dat$Pride_Memory1)
dat$Pride_Memory2 <- as.character(dat$Pride_Memory2)
dat$Pride_Memory3 <- as.character(dat$Pride_Memory3)
dat$Neutral_Memory1 <- as.character(dat$Neutral_Memory1)
dat$Neutral_Memory2 <- as.character(dat$Neutral_Memory2)
dat$Neutral_Memory3 <- as.character(dat$Neutral_Memory3)

# Set correct levels
levels(dat$Other_Nationality)[levels(dat$Other_Nationality)==""] <- "Dutch"
```

### Meaning of Column Headers

* Qualtrics Automatic Headers
    + "StartDate"
    + "EndDate"
    + "Status"
    + "IPAddress" 
    + "Progress"
    + "Duration (in seconds)"	
    + "Finished"
    + "RecordedDate"
    + "ResponseId"
    + "LocationLatitude"
    + "LocationLongitude"
    + "DistributionChannel"

* Emotion_.... 
    + _Consent
        + Was consent given? Yes / No  *[if No than automatically redirected to end of experiment]*
    + _Stdnr
        + Studentnumber in order to award participation credits to the accurate student & exclude for taking part twice
    + _Memory1/2/3
        + Text input of 400-450 characters by the participants recalling an emotionally salient event
    + _Intensity1/2/3
        + Intensity of the memory as self-reported by the participants on a 7 point Likert Scale
  
* C_Emotion 
    + Current emotional status on 7 point Likert scales for each of the mentioned emotions, including general positive and negative valence and arousal levels

* Demographics
    + Gender
        + 1 = Men
        + 2 = Women
        + 3 = Other + Text in "Other_Gender" Column
    + Age
        + Current age in years
    + Nationality
        + 1 = Dutch
        + 2 = Other + Text in "Other_Nationality" Column

* Helping
    + *[One of the following conditions through random assignment]*
    + Helping_Ingroup
        + 1 = Yes *[continue to coding of voiceclips]*
        + 2 = No *[exit experiment]*
    + Helping_Outgroup
        + 1 = Yes *[continue to coding of voiceclips]*
        + 2 = No *[exit experiment]*

* Embedded Data
    + Helping_Finish
        + Time pp chose to stop helping in seconds since *"Javascript's January 1st, 1970"* 
    + Helping_Start
        + Time that the pp chose to start the helping task in seconds since *"Javascript's January 1st, 1970"*
    + Trials               
        + Amount of voice clips the participant analysed, if chosen to help, NA's are pp that did not help
    + Emotion_Condition    
        + Which condition the pp were assigned to 
            + Neutral
            + Love
            + Awe
            + Pride
    + Trial_Vector
        + Empty, was needed to compute the amount of Trials as a JavaScript add_on in Qualtrics
    + Recipient_Condition
        + Whether the pp was asked to help the in/ or out-group recipient 
            + in-group = University of Amsterdam (Netherlands)
            + out-group = Goethe University Frankfurt (Germany)
    + Helping
        + Did the participant help?
            + 1 = Yes
            + 2 = No
    + Helping_Time
        + Amount of time participants spent helping
            + 0 if pp did not help
            + Delta_time calculated from Helping_Finish & Helping_Start for pp who did help

* UVA LAB Settings 
    + tid_Labuva
        + unknown
    + userid_labuva        
        + Unique userID per pp

* Other
    + Device
        + "Mobile" if mobile phone was used
        + NA = Computer

* Calculated Variables
   + Emotion_Condition_
      + Re-grouping of participants based on self-reported current feelings
      + _New
        + Assignment of participants to which feeling was rated highest by the participant
      + _New2
        + Assignment of participants based on current feeling ratings higher than group mean
      + _New3
        + 2 Conditions: Positive Emotions Condition [Love, Awe,Pride] & Neutral
    + Memory_
      + 1_pos / 2_pos / 3_pos: percentage of positive emotion words in memory 1, 2, and 3
      + 1_neg / 2_neg / 3_neg: percentage of negative emotion words in memory 1, 2, and 3
    + Mean_Memory_Pos
      + Mean percentage of positive emotion words used across three memories
    + Mean_Memory_Neg
      + Mean percentage of negative emotion words used across three memories

***

## Exclusions

### Pre-specified Criteria
#### Nationality
Participants with a nationality other than Dutch were excluded (N = 3), because the beneficiary manipulation was based on Dutch recipients being the participants’ in-group and German beneficiaries the participants’ out-group.

``` {r}
## Remove rows if Nationality == 2 == Non-Dutch
dat <- dat[grep(2, dat$Nationality, invert=TRUE),]
```

#### Gibberish
Participants (N = 2) were excluded if their memories contained gibberish words, or repeated a character or sentence multiple times. Participants to be excluded were identified by inspecting of the data.

``` {r}
## Through manual checks of the provided memories
## Studentnumbers:
  # 11025255 - Love Condition
  # 11200170 - Neutral Condition

## Remove rows
dat <- dat[-(as.numeric(which(dat$Love_Stdnr == "11025255"))),]
dat <- dat[-(as.numeric(which(dat$Neutral_Stdnr == "11200170"))),]

```

#### Current Emotion Scores
It was stated in the research proposal that the data of participants with a score on the target emotion larger than 2 SD from the group average would be excluded from analysis. 

**Love**  
```{r}
descrp_Love <- describe(dat$C_Love[dat$Emotion_Condition == "love"])
upper_boundary <- (descrp_Love$mean + (2*descrp_Love$sd))
lower_boundary <- (descrp_Love$mean - (2*descrp_Love$sd))

exclude_Love <- subset(x = dat, subset = (dat$C_Love > upper_boundary || dat$C_Love < lower_boundary))

## N = ...                         
cat(nrow(exclude_Love))
```

**Awe**  
```{r}
descrp_Awe <- describe(dat$C_Awe[dat$Emotion_Condition == "awe"])
upper_boundary <- (descrp_Awe$mean + (2*descrp_Awe$sd))
lower_boundary <- (descrp_Awe$mean - (2*descrp_Awe$sd))

exclude_Awe <- subset(x = dat, subset = (dat$C_Awe > upper_boundary || dat$C_Awe < lower_boundary))
                         
cat(nrow(exclude_Awe))
```

**Pride**   
```{r}
descrp_Pride <- describe(dat$C_Pride[dat$Emotion_Condition == "pride"])
upper_boundary <- (descrp_Pride$mean + (2*descrp_Pride$sd))
lower_boundary <- (descrp_Pride$mean - (2*descrp_Pride$sd))

exclude_Pride <- subset(x = dat, subset = (dat$C_Pride > upper_boundary || dat$C_Pride < lower_boundary))

## N = ...                       
cat(nrow(exclude_Pride))
```

**Conclusion**

Based on the participant scores, group averages, and group SD, 0 participants were excluded based on this criterion.

***

### Additional Exclusion Criteria

After inspecting the data, it became evident that two additional exclusion criteria were warranted.

#### Incomplete data
``` {r} 
## Through manual checks of the provided memories
## Studentnumbers:
  # 10743057 - Pride Condition

## Remove rows
dat <- dat[-(as.numeric(which(dat$Pride_Stdnr == "10743057"))),]

## N = ...
cat(1)

```

#### Multiple Experiment Starts

[i.e. exposure to multiple conditions]  

Identified at UVA lab site: https://www.lab.uva.nl/LAB/recruitment/Projects/edit_participations/7786]

  * Copy & Paste to new Excel Sheet
  * Highlight duplicate values in "Username" column
  * Copy student number
  * Find student number in Qualtrics Data Sheet 

``` {r}
## Studentnumbers
  # 11226439 - Awe
  # 10479279 - Neutral
  # 11327065 - Awe
  # 10586903 - Neutral
  # 10745599 - Already excluded based on Nationality
  # 11289171 - Love

## Remove rows
dat <- dat[-(as.numeric(which(dat$Awe_Stdnr == "11226439"))),]
dat <- dat[-(as.numeric(which(dat$Neutral_Stdnr == "10479279"))),]
dat <- dat[-(as.numeric(which(dat$Awe_Stdnr == "11327065"))),]
dat <- dat[-(as.numeric(which(dat$Neutral_Stdnr == "10586903"))),]
dat <- dat[-(as.numeric(which(dat$Love_Stdnr == "11289171"))),]

## N = ...
cat(5)
```

#### Significant Duration
``` {r} 
## Duration over 17 hours

## Studentnumbers:
  # 11240547 - Awe Condition

## Remove rows
dat <- dat[-(as.numeric(which(dat$Awe_Stdnr == "11240547"))),]

## N = ...
cat(1)

```

***
***

# Descriptives

## N Participants per Condition

### Emotion Condition

The number of participants in each condition.

``` {r}
dat$Emotion_Condition <- factor(dat$Emotion_Condition) # remove uneccesary factors
Emotion_participants <- summary(dat$Emotion_Condition)

Participant_overview_matrix <- matrix(data = c( Emotion_participants[1], Emotion_participants[2], Emotion_participants[3],   Emotion_participants[4], 
((Emotion_participants[1]/nrow(dat))*100), ((Emotion_participants[2]/nrow(dat))*100), ((Emotion_participants[3]/nrow(dat))*100), ((Emotion_participants[4]/nrow(dat))*100)), nrow = 2, byrow = TRUE, dimnames = list(c("Absolute N", "Percentage"), c("Awe", "Love", "Neutral", "Pride") ))

round(Participant_overview_matrix, 2)
```

**NOTE**

There is an unequal distribution of participants across conditions. This could be due to a mistake in the design of the experiment. This seems unlikely as the design is fairly straightforward and we have not been able to detect any mistakes. It is also possible that the randomization function as advertised by Qualtrics (the survey/experiment host software) does not function as it should. In other words, it could be that their randomization function, in fact does not guarantee a randomized, but equal, distribution of participants across conditions. Thirdly, it is possible that the unequal distribution of participants across conditions is caused by participants dropping out and/or starting the experiment multiple times. If each start of the experiment is logged as a participant in that condition, after excluding the data that could not be used, this could leave a skewed distribution across conditions. 

Regardless of the cause of the unequal distribution, this should be taken into account for future analyses as they generally are based on the assumption of equal sample sizes. 

### Recipient Condition

```{r}
dat$Recipient_Condition <- factor(dat$Recipient_Condition)
table(dat$Recipient_Condition)
```

### Combined

```{r}
table(dat$Emotion_Condition, dat$Recipient_Condition)
```

***

## Demographics
### Gender
``` {r}
dat$Gender <- factor(x = dat$Gender)
levels(dat$Gender) <- c("men", "women")

summary(dat$Gender)
```
### Age
``` {r}
describe(dat$Age)
```
### Nationality

All participants were Dutch, as participants with other nationalities were excluded

## Other

We also tracked whether participants completed the experiment on their mobile or on the computer.

``` {r}
dat$Device <- factor(dat$Device)
levels(dat$Device) <- c("Other", "Mobile")
summary(dat$Device)
```

***

# Emotion Induction

## Criterion 1 - Planned

Emotion induction is succesful if participants in each of the conditions rate their current feeling on that specific feeling higher than participants in other conditions (Piff et al., 2015) [^2]. For example, participants in the love condition report higher levels of current love than participants in the other conditions. 

### Vizualization of Data

``` {r fig.cap ="Figure 1. Current Feeling: Love. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line. All individual datapoints are represented by single dots."}
pirateplot(dat$C_Love ~ dat$Emotion_Condition, data = dat, pal = gray(.7), xlab = "Emotion_Condition",
           main = "Self Report of Current Feeling - Love", ylab = "Current_Love", ylim=c(1,7))

data_pirateplot_love <- pirateplot(dat$C_Love ~ dat$Emotion_Condition, data = dat, plot = FALSE, ylim=c(1,7))
```

```{r fig.cap = "Figure 2. Q-Q Plot of Self Report Current Feelings of Love"}
qqnorm(dat$C_Love); qqline(dat$C_Love)
```

``` {r fig.cap ="Figure 3. Current Feeling: Awe. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line. All individual datapoints are represented by single dots."}
pirateplot(dat$C_Awe ~ dat$Emotion_Condition, data = dat, pal = gray(.7), xlab = "Emotion_Condition",
           main = "Self Report of Current Feeling - Awe", ylab = "Current_Awe", ylim=c(1,7))

data_pirateplot_awe <- pirateplot(dat$C_Awe ~ dat$Emotion_Condition, data = dat, ylim=c(1,7), plot = FALSE)
```

```{r fig.cap = "Figure 4. Q-Q Plot of Self Report Current Feelings of Awe"}
qqnorm(dat$C_Awe); qqline(dat$C_Awe)
```

``` {r fig.cap ="Figure 5. Current Emotion: Pride. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line.All individual datapoints are represented by single dots. "}
pirateplot(dat$C_Pride ~ dat$Emotion_Condition, data = dat, pal = gray(.7), xlab = "Emotion_Condition",
           main = "Self Report of Current Feeling - Pride", ylab = "Current_Pride", ylim=c(1,7))

data_pirateplot_pride <- pirateplot(dat$C_Pride ~ dat$Emotion_Condition, data = dat, ylim=c(1,7), plot = FALSE)
```

```{r fig.cap = "Figure 6. Q-Q Plot of Self Report Current Feelings of Pride"}
qqnorm(dat$C_Pride); qqline(dat$C_Pride)
```

***

### MANOVA Assumption Checks

#### Independence of Observations
**Interpretation**  

The ICC measures the correlation between DV's. If the correlation of the "Single_raters_absolute" is significant, this indicates that the observations are not independent, and thus the assumption of the MANOVA is violated [^1].


**Analysis**
``` {r}
ind_manova_emotion_check <- ICC(cbind(dat$C_Love, dat$C_Awe, dat$C_Pride))
print(ind_manova_emotion_check)
```  

**Conclusion**

The Single_raters_absolute ICC is (0.087) not significant (p = 0.09295). This indicates that the observations of the MANOVA (i.e. scores on the Current Love, Current Awe, and Current Pride scales) are independent. The assumption is NOT violated.

***

#### Multivariate Normality
**Interpretation**

Significant results of the Shapiro-Wilk Test for multivariate normality indicate violation of multivariate normality. Field, however, illustrates that large samples will most likely result in significant Shapiro-Wilk tests. Thus, the data should also be analyzed when plotted. 

**Analyses**

Shapiro-Wilk Test **Induced Emotion Condition: Awe**

``` {r}
DV_Awe <- subset(x = dat, dat$Emotion_Condition == "awe", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Awe[,1:3]))
```

Shapiro-Wilk Test **Induced Emotion Condition: Love**

``` {r}
DV_Love <- subset(x = dat, dat$Emotion_Condition == "love", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Love[,1:3]))

```

Shapiro-Wilk Test **Induced Emotion Condition: Pride**

``` {r}
DV_Pride <- subset(x = dat, dat$Emotion_Condition == "pride", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Pride[,1:3]))

```

Shapiro-Wilk Test **Induced Emotion Condition: Neutral**

``` {r}
DV_Neutral <- subset(x = dat, dat$Emotion_Condition == "neutral", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Neutral[,1:3]))
```

If multivariate normality is violated then look at the outliers, to see if removing them might normalize the data. If not, conduct a robust MANOVA (Field, 2012, p. 895)

``` {r fig.cap = "Figure 7. Series of four plots to determine influential outliers (red)."}
aq.plot(x = dat[,45:47]) 
# col 45 = C_Love, col 46 = C_Awe, col 47 = C_Pride
```

**Conclusion**

The Shapiro-Wilk tests for normality indicate that the multivariate normality assumptions are violated for the Love, Pride, and Neutral Emotion Induction Conditions. Furthermore, row 66 and row 73 are identified as outliers. Violations of multivariate normality are supported by the earlier plots which clearly show the absence of normally distributed data in, for example, the Neutral condition.  

##### Removing Outliers

**Goal:** to determine whether multivariate normality can be restored by identifying and deleting outliers. 

```{r}

outlier_excluded_data <- dat[-c(66, 73),] #remove outlier row 67 and 73 from dataset

# re-run multivariate normality tests
DV_Awe_outlier <- subset(x = outlier_excluded_data, outlier_excluded_data$Emotion_Condition == "awe", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Awe_outlier[,1:3]))

```
```{r}
DV_Love_outlier <- subset(x = outlier_excluded_data, outlier_excluded_data$Emotion_Condition == "love", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Love_outlier[,1:3]))
```
``` {r}
DV_Pride_outlier <- subset(x = outlier_excluded_data, outlier_excluded_data$Emotion_Condition == "pride", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Pride_outlier[,1:3]))

```
```{r}
DV_Neutral_outlier <- subset(x = outlier_excluded_data, outlier_excluded_data$Emotion_Condition == "neutral", select = c(C_Love, C_Awe, C_Pride))

mshapiro.test(t(DV_Neutral_outlier[,1:3]))

```
**Conclusion**

Removing the outliers (N=2) does not influence the normality of the dependent variables. Consequently, the multivariate normality assumption is still violated. However, “Results from various studies that considered up to 10 variables and small or moderate sample sizes […] indicate that deviation from multivariate normality has only a small effect on type I error (Stevens, 2009, p. 222)". Thus, even though the multivariate normality assumption is violated, this is not cause for concern. 

***

#### Homogeneity of Covariances

**Interpretation**

Significant value of Box's M-test indicates heterogeneity of covariance matrices

**Covariance Matrices**

``` {r}
DVs <- cbind(dat$C_Love, dat$C_Awe, dat$C_Pride) # dependent variables
colnames(DVs) <- c("C_Love", "C_Awe", "C_Pride")

by(DVs, dat$Emotion_Condition, cov)

```

**Analysis**
``` {r}
# DVs = cbind(dat$C_Love, dat$C_Awe, dat$C_Pride)
# IV = Emotion_Condition

homo_manova_emotion_check <- boxM(data = DVs, grouping = dat$Emotion_Condition)
print(homo_manova_emotion_check)

```
**Conclusion**

The Box's M-test for homogeneity of covariances is non significant(p = 0.1683). This assumption is thus NOT violated. 

***

### Fit MANOVA 

Based on the assumption checks it became evident that only the multivariate normality assumption has been violated. However, the type I error is not significantly influenced by this violation, and thus a MANOVA can still be executed (Finch, 2015). 

**Interpretation**

Significant p-value indicates that the groups differ on the dependent variables. Reason for post-hoc ANOVA analyses to determine on which DV the groups differ specifically.

**Fitting**
``` {r}
manova_emotion_check <- manova(cbind(dat$C_Love, dat$C_Awe, dat$C_Pride) ~ dat$Emotion_Condition, data = dat)

summary(manova_emotion_check, type="Pillai", intercept = TRUE)
```

**Conclusion**
The four emotion conditions (Love, Awe, Pride, and Neutral) differ significantly (Pillai's Trace = 0.29993, F [1,3] = 2.81, p = 0.003739) on the dependent variables: Current ratings of Love, Awe, and Pride. Participants across all four conditions do not rate their current feelings in a similar way. 

***

### Post-Hoc Analyses - ANOVAs

**Interpretation**

Significant post-hoc ANOVA's indicate that the emotions conditions (love, awe, pride, neutral) differed on ratings of the current feelings of love, awe, or pride.

**Analyses**

with... 

* Response 1 = DV: Current Emotion - Love
* Response 2 = DV: Current Emotion - Awe
* Response 3 = DV: Current Emotion - Pride

``` {r}
post_hoc_anova_emotion <- summary.aov(manova_emotion_check)
post_hoc_anova_emotion
```

Bonferroni Correction for multiple comparrisons

``` {r}
# Store p-values from the post-hoc anova's, indexed by [[which anova]][1st item of 5th item]
p_values_emotion_anovas <- c(post_hoc_anova_emotion[[1]][1,5], post_hoc_anova_emotion[[2]][1,5],post_hoc_anova_emotion[[3]][1,5])

# Round the adjusted p-values (bonferroni correction) to three digits
round(p.adjust(p_values_emotion_anovas,method="bonferroni", n = length(p_values_emotion_anovas)), digits = 3)

```

**Conclusion**

Based on an alpha level of 0.05, the emotion conditions differ only on the DV current emotion - pride. However, because the multivariate normality assumption was violated, and the Q-Q plots provide graphical evidence that univariate normality most likely also is violated, a carefull analysis of the plots is also in order. 

When viewing the data for the current emotion Love, it becomes evident that participants in the four conditions score fairly similary on current feelings of love. It should, however, been taken into account that the data are not normally distributed within conditions. For example, the sample distribution of the pride condition on current love displays a positive skewness. 

The DV current emotion: Awe marginally does not reach significance. When viewing the plots, it shows that the Neutral condition is negatively skewed when assessing current emotions of awe. In addition, participants in the love condition show a very large variance in current feelings of awe. These facts together provide explanations as to why the groups might not differ significantly from eachother on this DV.

The emotion conditions differ significantly on current experiences of Pride. Interestingly enough, the plot shows that participants in the pride condition actually do not score higher on current feelings of pride than participants in the love condition. This difference especially is interesting to approach with a t-test.

***

### Post-Hoc Analyses - t-tests
```{r}
# based on group means compare 2 groups with highest group means (pride & love)
# equal variances not assumed
t.test(x = DV_Love$C_Love, y = DV_Pride$C_Love, var.equal = FALSE)
```

```{r}
# based on group means compare 2 groups with highest group means (awe & love)
# equal variances not assumed
t.test(x = DV_Awe$C_Awe, y = DV_Love$C_Awe, var.equal = FALSE)
```

```{r}
# based on group means compare 2 groups with highest group means (pride & love)
# equal variances not assumed
t.test(x = DV_Pride$C_Pride, y = DV_Love$C_Pride, var.equal = FALSE)
```

***

### Conclusion

The current sample was not susceptible to the emotion induction according to the first criterion. Participants did not rate their current feelings of the target emotion higher than participants in the other emotion conditions. This criterion was copied from Piff et al. (2015) from whom we also used the method.

## Criterion 2 - Exploratory

A less stringent criterion for successful emotion induction is that participants in each emotion condition should rate their feelings of the target emotion higher than other current feelings. In other words, participants in the love condition should rate their feelings of love higher than their feelings of awe and pride. 

### Vizualization of Data

```{r include = FALSE}
#### AWE ####
# Turn Data to long matrix
DV_Awe_long <- matrix(t(DV_Awe), ncol = 1)
DV_Awe_long <- as.data.frame(DV_Awe_long)

# append new column
DV_Awe_long$Current_Feeling <- rep(c("Love", "Awe", "Pride"), nrow(DV_Awe))
colnames(DV_Awe_long) <- c("Rating", "Current_Feeling")

# covert to factor to allow plotting
DV_Awe_long$Current_Feeling <- factor(DV_Awe_long$Current_Feeling)

#### LOVE #### 

# Turn Data to long matrix
DV_Love_long <- matrix(t(DV_Love), ncol = 1)
DV_Love_long <- as.data.frame(DV_Love_long)

# append new column
DV_Love_long$Current_Feeling <- rep(c("Love", "Awe", "Pride"), nrow(DV_Love))
colnames(DV_Love_long) <- c("Rating", "Current_Feeling")

# covert to factor to allow plotting
DV_Love_long$Current_Feeling <- factor(DV_Love_long$Current_Feeling)

#### PRIDE ####

# Turn Data to long matrix
DV_Pride_long <- matrix(t(DV_Pride), ncol = 1)
DV_Pride_long <- as.data.frame(DV_Pride_long)

# append new column
DV_Pride_long$Current_Feeling <- rep(c("Love", "Awe", "Pride"), nrow(DV_Pride))
colnames(DV_Pride_long) <- c("Rating", "Current_Feeling")

# covert to factor to allow plotting
DV_Pride_long$Current_Feeling <- factor(DV_Pride_long$Current_Feeling)

```

```{r fig.cap= "Figure 8. Emotion Condition: Love. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line. All individual datapoints are represented by single dots."}

pirateplot(DV_Love_long$Rating ~ DV_Love_long$Current_Feeling, data = DV_Love_long, pal = gray(.7), xlab = "Current Feelings of ...", main = "Emotion Condition: Love", ylab = "Self Report Rating", ylim=c(1,7))
```

```{r fig.cap= "Figure 9. Emotion Condition: Awe. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line. All individual datapoints are represented by single dots."}

pirateplot(DV_Awe_long$Rating ~ DV_Awe_long$Current_Feeling, data = DV_Awe_long, pal = gray(.7), xlab = "Current Feelings of ...", main = "Emotion Condition: Awe", ylab = "Self Report Rating", ylim=c(1,7))
```

```{r fig.cap= "Figure 10. Emotion Condition: Pride. The horizontal black line represent the group average. The solid boxes represent the 95% CI. The distribution of scores is outlined by a black line. All individual datapoints are represented by single dots."}

pirateplot(DV_Pride_long$Rating ~ DV_Pride_long$Current_Feeling, data = DV_Pride_long, pal = gray(.7), xlab = "Current Feelings of ...", main = "Emotion Condition: Pride", ylab = "Self Report Rating", ylim=c(1,7))
```

***

### Paired Sample t-tests
```{r}
# Data for love in DV_Love
tt_1 <- t.test(DV_Love$C_Love, DV_Love$C_Pride, paired = TRUE)
tt_2 <- t.test(DV_Love$C_Love, DV_Love$C_Awe, paired = TRUE)

# Data for awe in DV_Awe
tt_3 <- t.test(DV_Awe$C_Awe, DV_Awe$C_Love, paired = TRUE)
tt_4 <- t.test(DV_Awe$C_Awe, DV_Awe$C_Pride, paired = TRUE)

# Data for Pride in DV_Pride
tt_5 <- t.test(DV_Pride$C_Pride, DV_Pride$C_Love, paired = TRUE)
tt_6 <- t.test(DV_Pride$C_Pride, DV_Pride$C_Awe, paired = TRUE)
```

Bonferroni correction for multiple comparisons (N = 6)

```{r}
# store p_values
all_emotion_induction2_p <- c(tt_1$p.value, tt_2$p.value, tt_3$p.value, tt_4$p.value, tt_5$p.value, tt_6$p.value)

# Round the adjusted p-values (bonferroni correction) to three digits
round(p.adjust(all_emotion_induction2_p,method="bonferroni", n = length(all_emotion_induction2_p)), digits = 3)
```

**Conclusion**
T-test 2/3/6 are significant (p < .05) after Bonferroni correction. This indicates that participants in the love condition rate their current feelings of love significantly higher than their current feelings of awe. In addition, participants in the awe condition rate their current feelings of awe lower than current feelings of love. Thirdly, participants in the pride condition rate their current feelings of pride higher than feelings of awe.

***

### Conclusion

The current sample was not susceptible to emotion induction. Participants did not rate their current feelings of the target emotion higher than other feelings.

## Re-distributing Participants

Even after adopting a less stringent criterion, we were unable to conclude successful emotion induction. We therefore attempted to re-distribute participants across conditions based on their self-report ratings of feeling the experimental emotions.







